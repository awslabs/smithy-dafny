# Code generated by smithy-python-codegen DO NOT EDIT.

import simple_constraints.smithygenerated.dafny_to_smithy
import module_
from simple_constraints_internaldafny_types import (
    GetConstraintsInput_GetConstraintsInput as DafnyGetConstraintsInput,
    GetConstraintsOutput_GetConstraintsOutput as DafnyGetConstraintsOutput,
)
import simple_constraints.smithygenerated.smithy_to_dafny

from .errors import (
    CollectionOfErrors,
    OpaqueError,
    ServiceError,
    SimpleConstraintsException,
)
from .models import GetConstraintsInput, GetConstraintsOutput


import Wrappers
import asyncio
import simple_constraints_internaldafny_types
import simple_constraints.smithygenerated.client as client_impl

def smithy_error_to_dafny_error(e: ServiceError):
    '''
    Converts the provided native Smithy-modelled error
    into the corresponding Dafny error.
    '''
    if isinstance(e, SimpleConstraintsException):
        return simple_constraints_internaldafny_types.Error_SimpleConstraintsException(message=e.message)

    if isinstance(e, CollectionOfErrors):
        return simple_constraints_internaldafny_types.Error_CollectionOfErrors(message=e.message, list=e.list)

    if isinstance(e, OpaqueError):
        return simple_constraints_internaldafny_types.Error_Opaque(obj=e.obj)

class SimpleConstraintsShim(simple_constraints_internaldafny_types.ISimpleConstraintsClient):
    def __init__(self, _impl: client_impl) :
        self._impl = _impl

    def GetConstraints(self, input: DafnyGetConstraintsInput) -> DafnyGetConstraintsOutput:
        # Import dafny_to_smithy at runtime to prevent introducing circular dependency on shim file
        from .dafny_to_smithy import DafnyToSmithy_simple_constraints_GetConstraintsInput
        smithy_client_request: GetConstraintsInput = simple_constraints.smithygenerated.dafny_to_smithy.DafnyToSmithy_simple_constraints_GetConstraintsInput(input)
        try:
            smithy_client_response = asyncio.run(self._impl.get_constraints(smithy_client_request))
        except ServiceError as e:
            return Wrappers.Result_Failure(smithy_error_to_dafny_error(e))

        return Wrappers.Result_Success(simple_constraints.smithygenerated.smithy_to_dafny.SmithyToDafny_simple_constraints_GetConstraintsOutput(smithy_client_response))
